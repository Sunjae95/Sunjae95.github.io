<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="layout-lang" content="ko"><meta name="day-prompt" content="d ago"><meta name="hour-prompt" content="hr ago"><meta name="minute-prompt" content="min ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Notion JS 리팩토링 회고" /><meta property="og:locale" content="ko" /><meta name="description" content="⏳기간: 2021/11/08 ~ 2021/11/12" /><meta property="og:description" content="⏳기간: 2021/11/08 ~ 2021/11/12" /><link rel="canonical" href="https://sunjae95.github.io/posts/Notion_Refactor/" /><meta property="og:url" content="https://sunjae95.github.io/posts/Notion_Refactor/" /><meta property="og:site_name" content="Sun’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-13T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Notion JS 리팩토링 회고" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-11-13T00:00:00+09:00","datePublished":"2021-11-13T00:00:00+09:00","description":"⏳기간: 2021/11/08 ~ 2021/11/12","headline":"Notion JS 리팩토링 회고","mainEntityOfPage":{"@type":"WebPage","@id":"https://sunjae95.github.io/posts/Notion_Refactor/"},"url":"https://sunjae95.github.io/posts/Notion_Refactor/"}</script><title>Notion JS 리팩토링 회고 | Sun's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Sun's Blog"><meta name="application-name" content="Sun's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sun's Blog</a></div><div class="site-subtitle font-italic">꾸준하게 공부하는 것이 중요해</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Sunjae95" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tjswo9502','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Notion JS 리팩토링 회고</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Notion JS 리팩토링 회고</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> SeonjaeLee </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 13, 2021, 12:00 AM +0900" >Nov 13, 2021<i class="unloaded">2021-11-13T00:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1731 words">9 min read</span></div></div><div class="post-content"><h2 id="기간-20211108--20211112">⏳기간: 2021/11/08 ~ 2021/11/12</h2><h2 id="목표">🏔목표</h2><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />정해진 기간에만 리팩토링 하기<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />컴포넌트의 책임에 대해 고민해보기<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />document 생성을 하면 sidebar와 editor가 새롭게 생성 되어야 한다.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />document 삭제기능<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />새로고침시 정보를 받아올수 없다는 창 나오지 않게 하기<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />토글버튼<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />editor 수정시 디바운스 되며, 로딩중이라고 사용자에게 보여주기<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />사용성 개선(포인터, hover효과)</ul><h2 id="프로젝트-구조">프로젝트 구조</h2><p><img data-proofer-ignore data-src="../../assets/img/posts/Notion_refactor.png" alt="Untitled" /></p><h2 id="app컴포넌트">App컴포넌트</h2><p>기존 프로젝트의 문제는 url이 <code class="language-plaintext highlighter-rouge">'/'</code> 아닌 곳에서 <code class="language-plaintext highlighter-rouge">새로 고침</code>을 하게 되면 현재 페이지가 아닌 <code class="language-plaintext highlighter-rouge">잘못된 페이지를 보여주는 문제점</code>이 있었다. 사실 이것을 문제라고 인지하기까지 꽤 오랜 시간이 걸렸다.</p><p>지금에서야 한 줄로 설명할 수 있었지만 그 당시에는 허둥지둥 대면서 뭐지? 맨 처음 페이지에서는 정상 실행되고 다른 페이지에서는 안되지 이러면서 계속 프로젝트를 빌드 해보고 종료해 보는 작업을 많이 하며 문제를 이해하게 되었다.</p><p>문제를 해결하기 위해 route관련된 강의와 JS로 SPA방식을 구현한 코드도 보며 이해하면서 공부를 했다.</p><p>그 결과 문제를 해결했지만 프로젝트 특성상 처음 렌더링이 된다면 따로 렌딩페이지를 보여주는 것이 아니라 DocumentList에서 처음 Document를 선택해 editor에 보여주기 때문에 이를 수용하기 위한 코드가 필요했다.</p><p>아래코드는 App이 렌딩시 현재 <code class="language-plaintext highlighter-rouge">url 확인 후 현재 Document내용을 전달</code>해주는 함수를 만들어 해결했다.</p><div lang="jsx" class="language-jsx highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">App</span><span class="p">({</span> <span class="nx">$target</span> <span class="p">})</span> <span class="p">{</span>
  <span class="c1">//...</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">route</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">pathname</span> <span class="p">}</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">;</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="c1">//아무것도 없을 때</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">pathname</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">nextState</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getDocument</span><span class="p">();</span>
        <span class="c1">//Document가 없다면 새로운 document를 만들어줘야됨</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">post</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createDocument</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
          <span class="kd">const</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">post</span><span class="p">;</span>

          <span class="nx">push</span><span class="p">(</span><span class="s2">`posts/</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
          <span class="nx">editPage</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">post</span><span class="p">);</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">push</span><span class="p">(</span><span class="s2">`posts/</span><span class="p">${</span><span class="nx">nextState</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="nx">editPage</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">nextState</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">/posts/</span><span class="dl">"</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//이미 선택된 페이지가 있다면 그곳으로 이동</span>
        <span class="kd">const</span> <span class="p">[,</span> <span class="p">,</span> <span class="nx">postId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">nextState</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getDocument</span><span class="p">(</span><span class="nx">postId</span><span class="p">);</span>

        <span class="nx">editPage</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">nextState</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">initRouter</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">());</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="sidebar컴포넌트">Sidebar컴포넌트</h2><p>기존 Sidebar컴포넌트는 Header와 DocumentList를 포함하는 컴포넌트였지만 DocumentList에 많은 이벤트가 있다 생각하여 Sidebar에 이벤트를 다루게 해주었다.</p><p>이러한 작업을 하려고 하니 Sidebar에 상태가 필요했다고 느꼈다.</p><p>그래서 처음 렌더링되면서 API결과를 불러오는 로직을 통해 DocumentList로 상태를 전달했으며, DocumentList에서 필요한 로직이 있다면 그것은 Sidebar에서 실행시키도록 했다.</p><p>이렇게 작성을 하니 DocumentList의 <code class="language-plaintext highlighter-rouge">코드 길이도 짧아지고 가독성이 높아</code>지는 경험을 했다.</p><div lang="jsx" class="language-jsx highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">DocumentList</span><span class="p">({</span> <span class="nx">$target</span><span class="p">,</span> <span class="nx">onAdd</span><span class="p">,</span> <span class="nx">onDelete</span><span class="p">,</span> <span class="nx">onChange</span> <span class="p">})</span> <span class="p">{</span>
  <span class="c1">//...</span>
  <span class="nx">$listContainer</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">click</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">document-container</span><span class="dl">"</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">$document</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="dl">"</span><span class="s2">ul</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">$addButton</span> <span class="o">=</span> <span class="nx">$document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">"</span><span class="s2">.add-btn</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">$deleteButton</span> <span class="o">=</span> <span class="nx">$document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">"</span><span class="s2">.delete-btn</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">$toggleButton</span> <span class="o">=</span> <span class="nx">$document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">"</span><span class="s2">.toggle-btn</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">$document</span><span class="p">.</span><span class="nx">dataset</span><span class="p">;</span>

    <span class="k">switch</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="na">$addButton</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">onAdd</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">case</span> <span class="na">$deleteButton</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">onDelete</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">case</span> <span class="na">$toggleButton</span><span class="p">:</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">$document</span><span class="p">.</span><span class="nx">className</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">list-off</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">$document</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">list-on</span><span class="dl">"</span><span class="p">;</span>
          <span class="nx">$toggleButton</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">▾</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">$document</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">list-off</span><span class="dl">"</span><span class="p">;</span>
          <span class="nx">$toggleButton</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">▸</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nl">default</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">onChange</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">setState</span> <span class="o">=</span> <span class="p">(</span><span class="nx">nextState</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">//...</span>
  <span class="p">};</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">render</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">//...</span>
  <span class="p">};</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><p>다만 토글 버튼은 document를 직접 관리하는 작업이므로 DocumentList에서는 다루기가 힘들어 로직을 그대로 넣었다.</p><h2 id="content--editor컴포넌트">Content | Editor컴포넌트</h2><p>Sidebar와 DocumentList의 구조와 1대1 매칭되는 부분이다. 여기서 추가된 부분은 Editor의 title부분을 수정하면 documentList의 일부분이 수정되어야지만 안됐던 부분을 현재 작성하고 있는 위치에서 ID값을 얻어 해당 value를 수정하는 방식을 사용했다.</p><p>문제는 해결했지만 이 부분에서 많은 고민을 했다. documentList와 Editor는 <code class="language-plaintext highlighter-rouge">의존성이 없는 컴포넌트인데</code> 이걸 의존성있게 하려면 <code class="language-plaintext highlighter-rouge">App에서 모든 데이터를 제어</code>하거나, 특정 트릭을 이용해 구현해야 된다고 생각했다.</p><p>그래서 내가 한 선택은 ID값을 이용해 낙관적 업데이트를 하는 트릭을 생각했다. 이는 의존성을 갖지 않게 하여 내가 원하는 의도이기 때문이었다.</p><h2 id="되돌아보기">🧭되돌아보기</h2><p>리팩토링의 방향을 정하지 않고 무지성으로 코드부터 건드려서 초기 프로젝트와는 많은 변동 사항이 있었다. 이 생각이 떠오른 이유는 내가 회고를 하면서 변경한 코드의 이유가 명확하지 않았기 때문이었다.</p><p>내가 생각하는 개발자는 코드 한 줄 한 줄에 논리가 있어야 된다고 생각한다.</p><p>정작 회고를 하면서 나는 나의 코드에 대해 명확한 이유가 없었구나 느꼈다.</p><p>회고를 하면서 리팩토링한 코드를 다시 읽어보며 3~4일전의 나는 왜 이렇게 짰지 많은 의문을 던지면서 이유를 찾아 회고를 했다.</p><p>이런 상황이 발생한 문제는 무엇인가 생각해 보니 내가 아직 익숙하지 않다고 생각했다. 프로젝트의 구조부터 컴포넌트를 어디까지 분리해야 되는지, 이벤트의 위임 등 많은 문제들이 나에게 와닿았다.</p><h3 id="keep">👍Keep</h3><ul><li>기간을 두고 리팩토링을 완주한 경험<li>다시 코드를 고쳐보려는 노력<li>모르는 것을 왜 모르는지 스스로에게 물어봄</ul><h3 id="problem">🚨Problem</h3><ul><li>리팩토링을 어떻게 해야될지 방향을 정하지 않음<li>컴포넌트부부만 신경써서 리팩토링 한 것<li>작업을 세분화하지 못해 commit의 내용과 다른 코드내용들이 섞인 부분</ul><h3 id="️try">🚵‍♂️Try</h3><ul><li>리팩토링시 충분한 QA를 통해 무엇을 얼마나 언제동안 할것인지 계획해보기<li>commit단위로 작업하기 위해 작업하다 고쳐야될 부분이 생각나면 다른 한쪽에 적고 현재 작업과 최대한 분리시키며 작업하기</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%EB%8D%B0%EB%B8%8C%EC%BD%94%EC%8A%A4/'>데브코스</a>, <a href='/categories/retrospective/'>Retrospective</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/programmers/" class="post-tag no-text-decoration" >programmers</a> <a href="/tags/frontend/" class="post-tag no-text-decoration" >frontend</a> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/devcourse/" class="post-tag no-text-decoration" >devcourse</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> <span class="text-muted small">-- Missing configuration options! --</span></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Notion JS 리팩토링 회고 - Sun's Blog&url=https://sunjae95.github.io/posts/Notion_Refactor/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Notion JS 리팩토링 회고 - Sun's Blog&u=https://sunjae95.github.io/posts/Notion_Refactor/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Notion JS 리팩토링 회고 - Sun's Blog&url=https://sunjae95.github.io/posts/Notion_Refactor/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', '')" data-toggle="tooltip" data-placement="top" title=""> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/This/">This</a><li><a href="/posts/ExecutionContext/">Execution Context(실행 컨텍스트)</a><li><a href="/posts/2w_1/">2주차 - 대시보드 페이지 구현</a><li><a href="/posts/TIL_27/">밀렸던 TIL</a><li><a href="/posts/VIF_project_KPT/">VIF 프로젝트 KPT 회고</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/programmers/">programmers</a> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/wanted/">wanted</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/baekjoon/">baekjoon</a> <a class="post-tag" href="/tags/wecode/">wecode</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/vue/">vue</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/DND/"><div class="card-body"> <span class="timeago small" >Nov 22, 2021<i class="unloaded">2021-11-22T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DND 언택트 해커톤 회고</h3><div class="text-muted small"><p> 해커톤에서 경험하고 싶은 것 제한 시간 내에 팀원들과 원활하게 의사소통하여 프로젝트의 목표를 설정하기 제한 시간 내에 목표에 가장 가까운 프로젝트를 완성(해커톤 완주) 해커톤에서 필요한 전략을 생각하고 팀원에게 도움주기 내가 직접 작성한 코드를 만들기 해커톤에서 경험한 것 사전준비 해커톤 참여 여부가 확정되고 해커톤 진행하기 ...</p></div></div></a></div><div class="card"> <a href="/posts/This/"><div class="card-body"> <span class="timeago small" >Aug 18, 2021<i class="unloaded">2021-08-18T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>This</h3><div class="text-muted small"><p> 개요 자바스크립트를 사용하면서 정확히는 모르지만 예측하며 사용했던 this에 대해 호기심이 생겨 공부하고 싶었다. 자바스크립트에서 This는 다른 언어의 this와는 다르다. 다른 특성 때문에 내가 정확히 사용을 못하지만, 예측은 가능하게 됐다고 생각한다. (참으로 아이러니 하다..)😅 이번 글을 통해 this를 이해할 수 있는 글을 써 보는 것...</p></div></div></a></div><div class="card"> <a href="/posts/TIL_17/"><div class="card-body"> <span class="timeago small" >Sep 8, 2021<i class="unloaded">2021-09-08T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TIL 17일차</h3><div class="text-muted small"><p> 무한 스크롤 구현방식 window의 scroll이벤트를 통해 스크롤링이 일어날 때마다 스크롤 위치가 화면 끝인지 확인하여 컨텐츠를 불러오는 방식 intersection observer 방식 구현 순서 DUMMY_DATA를 사용해서 5장의 사진을 불러오기 API를 연동해서 5장의 사진을 불러오기 불러오기 버튼을 만들어 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/square/" class="btn btn-outline-primary" prompt="previous"><p>Programmers - 멀쩡한 사각형</p></a> <a href="/posts/DND/" class="btn btn-outline-primary" prompt="next"><p>DND 언택트 해커톤 회고</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">SeonjaeLee</a>. <span class="text-muted">-- Missing configuration options! --</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/frontend/">frontend</a> <a class="post-tag" href="/tags/programmers/">programmers</a> <a class="post-tag" href="/tags/devcourse/">devcourse</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/wanted/">wanted</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/baekjoon/">baekjoon</a> <a class="post-tag" href="/tags/wecode/">wecode</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/vue/">vue</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://sunjae95.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
